function applyFilters(){for(let e=2;e<rows.length;e++){const t=rows[e];let s=!0;for(const e in filters){const l=filters[e].value.toLowerCase(),r=t.querySelector(`td[data-field="${e}"]`),o=r?r.textContent.toLowerCase():"";if(""!==l&&-1===o.indexOf(l)){s=!1;break}}t.style.display=s?"":"none"}}function createFilterInput(e){const t=e.getAttribute("data-field"),s=document.createElement("input");return s.classList.add("form-control"),s.classList.add("form-control-sm"),s.type="text",s.placeholder="Filter...",s.setAttribute("id","field"),s.addEventListener("input",applyFilters),filters[t]=s,s}function createFilterSelect(e){const t=e.getAttribute("data-field"),s=[...new Set(Array.from(document.querySelectorAll(`td[data-field="${t}"]`)).map(e=>e.textContent))].sort(),l=document.createElement("select");l.classList.add("form-select"),l.classList.add("form-select-sm"),l.setAttribute("autocomplete","off"),l.id=t;var r=document.createElement("option");r.value="",r.text="All",l.appendChild(r);for(var o=0;o<s.length;o++){r=document.createElement("option");r.value=s[o],r.text=s[o],l.appendChild(r)}return l.addEventListener("change",applyFilters),filters[t]=l,l}function createFilterInputs(){const e=document.querySelector("thead"),t=document.createElement("tr");t.id="filter",t.classList.add("d-none");for(let e=0;e<columns.cells.length;e++){const s=columns.cells[e],l=s.getAttribute("data-field"),r=document.createElement("th");switch(r.setAttribute("data-field",l),s.getAttribute("data-filter-control")){case"select":const e=createFilterSelect(s);r.appendChild(e);break;case"input":const t=createFilterInput(s);r.appendChild(t)}t.appendChild(r)}e.appendChild(t)}function showFilter(){const e=document.getElementById("filter");e.classList.toggle("d-none")}function applySort(e,t){const s=Array.prototype.slice.call(rows,2);s.sort((s,l)=>{const r=s.querySelector(`td[data-field="${e}"]`).textContent,o=l.querySelector(`td[data-field="${e}"]`).textContent;return t?r.localeCompare(o):o.localeCompare(r)});for(let e=0;e<s.length;e++)table.tBodies[0].appendChild(s[e])}function toggleSortClass(e,t){e.classList.toggle("sorted-none",!1),e.classList.toggle("sorted-asc",t),e.classList.toggle("sorted-desc",!t)}function resetSortClasses(){for(let e=0;e<headers.length;e++)headers[e].querySelector("div.sortable").classList.remove("sorted-asc","sorted-desc"),headers[e].querySelector("div.sortable").classList.add("sorted-none")}const table=document.getElementById("table"),columns=document.getElementById("columns"),rows=table.getElementsByTagName("tr"),headers=columns.getElementsByTagName("th"),filters={};createFilterInputs(),resetSortClasses();const showFilters=document.getElementsByClassName("show-filter");for(let e=0;e<showFilters.length;e++)showFilters[e].addEventListener("click",showFilter);for(let e=0;e<headers.length;e++){const t=headers[e].getAttribute("data-field"),s=headers[e].querySelector("div.sortable");s.addEventListener("click",function(){const e=!this.classList.contains("sorted-asc");resetSortClasses(),toggleSortClass(this,e),applySort(t,e)})}